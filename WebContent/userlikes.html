<!doctype html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="viewport"
        content="width=device-width, initial-scale=1">
  <title>Hello Amaze UI</title>

  <!-- Set render engine for 360 browser -->
  <meta name="renderer" content="webkit">

  <!-- No Baidu Siteapp-->
  <meta http-equiv="Cache-Control" content="no-siteapp"/>

  <link rel="icon" type="image/png" href="assets/i/favicon.png">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="icon" sizes="192x192" href="assets/i/app-icon72x72@2x.png">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Amaze UI"/>
  <link rel="apple-touch-icon-precomposed" href="assets/i/app-icon72x72@2x.png">

  <!-- Tile icon for Win8 (144x144 + tile color) -->
  <meta name="msapplication-TileImage" content="assets/i/app-icon72x72@2x.png">
  <meta name="msapplication-TileColor" content="#0e90d2">

  <link rel="stylesheet" href="assets/css/amazeui.min.css">
  <link rel="stylesheet" href="assets/css/app.css">
	<script src="assets/js/jquery.min.js"></script>
		<script>
			function setCookie(cname,cvalue,exdays)
{
  var d = new Date();
  d.setTime(d.getTime()+(exdays*24*60*60*1000));
  var expires = "expires="+d.toGMTString();
  document.cookie = cname + "=" + cvalue + "; " + expires;
}
	
	function getCookie(cname)
{
  var name = cname + "=";
  var ca = document.cookie.split(';');
  for(var i=0; i<ca.length; i++) 
  {
    var c = ca[i].trim();
    if (c.indexOf(name)==0) return c.substring(name.length,c.length);
  }
  return "";
}
	function logout(){
		 function delCookie(key) {
        var date = new Date();
        date.setTime(date.getTime() - 1);
        var delValue = getCookie(key);
        if (!!delValue) {
            document.cookie = key+'='+delValue+';expires='+date.toGMTString();
        }
    }
		delCookie("nickname");
		delCookie("userid");
		delCookie("admin");
		window.location.href="index.html";
	}
			
			
function getQueryString(name) {
	var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
	var r = window.location.search.substr(1).match(reg);
	if (r != null) return r[2]; return null;
}
			
</script>	
</head>
<!公共头部>
<header class="am-topbar am-topbar-inverse">
  <h1 class="am-topbar-brand">
   <img class="am-circle" src="http://amazeui.shopxo.net/static/images/100.jpg" width="40" height="40"/>
  </h1>

  <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only" data-am-collapse="{target: '#doc-topbar-collapse'}"><span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span></button>

  <div class="am-collapse am-topbar-collapse" id="doc-topbar-collapse">
    <ul class="am-nav am-nav-pills am-topbar-nav">
      <li class=""><a href="user.html">个人资料</a></li>
	<li class="am-active"><a href="userlikes.html?likespage=1">我的收藏</a></li>
     <li><a href="shoppingCart.html?SCpage=1">我的购物车</a></li>
	<li><a href="userbuy.html?buypage=1">我的已购</a></li>
	<li><a href="index.html">返回首页</a></li>
		<button class="am-btn am-btn-primary am-topbar-btn" data-am-modal="{target: '#QRcode'}" id="money">充值(余额)</button>
    </ul>

    <div class="am-topbar-right">
      <button class="am-btn am-btn-primary am-topbar-btn am-btn-sm" onClick="logout();">退出登录</button>
    </div>
  </div>
</header>
<body>
<!--在这里编写你的代码-->
 <div class="am-g" >
  <div class="am-u-sm-4">4</div>
  <div class="am-u-sm-4">
	  <div align="center">
	 <img class="am-circle" src="http://amazeui.shopxo.net/static/images/100.jpg" width="140" height="140"/>
<div class="am-panel am-panel-primary">
  <div class="am-panel-hd">
    <h3 class="am-panel-title" id="username">user</h3>
  </div>
  <div class="am-panel-bd">
    <p>这里是您的收藏。</p>
  </div>
  <table class="am-table am-table-centered">
   <thead>
        <tr>
            <th>书名</th>
            <th>作者</th>
			<th>操作</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td id="like_book_1">用户名</td>
            <td id="like_Au_1">http://amazeui.org</td>
			<td><button class="am-badge am-badge-danger" onClick="dellikes(1)">删除</button></td>
        </tr>
        <tr>
            <td id="like_book_2">真实姓名</td>
            <td id="like_Au_2">http://amazeui.org</td>
			<td><button class="am-badge am-badge-danger" onClick="dellikes(2)">删除</button></td>
        </tr>
		<tr>
            <td id="like_book_3">身份证</td>
            <td id="like_Au_3">http://amazeui.org</td>
			<td><button class="am-badge am-badge-danger" onClick="dellikes(3)">删除</button></td>
        </tr>
        <tr>
            <td id="like_book_4">手机号</td>
            <td id="like_Au_4">http://amazeui.org</td>
			<td><button class="am-badge am-badge-danger" onClick="dellikes(4)">删除</button></td>
        </tr>
        <tr>
            <td id="like_book_5">邮箱</td>
            <td id="like_Au_5">http://amazeui.org</td>
			<td><button class="am-badge am-badge-danger" onClick="dellikes(5)">删除</button></td>
        </tr>
        <tr>
            <td id="like_book_6">生日</td>
            <td id="like_Au_6">http://amazeui.org</td>
			<td><button class="am-badge am-badge-danger" onClick="dellikes(6)">删除</button></td>
        </tr>
		<tr>
            <td id="like_book_7">地址</td>
            <td id="like_Au_7">http://amazeui.org</td>
			<td><button class="am-badge am-badge-danger" onClick="dellikes(7)">删除</button></td>
        </tr>
		<tr>
            <td id="like_book_8">性别</td>
            <td id="like_Au_8">http://amazeui.org</td>
			<td><button class="am-badge am-badge-danger" onClick="dellikes(8)">删除</button></td>
        </tr>
    </tbody>
  </table>
  <ul class="am-pagination am-pagination-centered">
  <li class="am-disabled"><a href="#">&laquo;</a></li>
  <li class="" id="likespage1"><a href="userlikes.html?likespage=1">1</a></li>
  <li class="" id="likespage2"><a href="userlikes.html?likespage=2">2</a></li>
  <li class="" id="likespage3"><a href="userlikes.html?likespage=3">3</a></li>
  <li class="" id="likespage4"><a href="userlikes.html?likespage=4">4</a></li>
  <li class="" id="likespage5"><a href="userlikes.html?likespage=5">5</a></li>
  <li><a href="#">&raquo;</a></li>
</ul>
</div>
	</div>
</div>
  <div class="am-u-sm-4">8</div>
</div> 

	
<!公共底部>
 <footer data-am-widget="footer"
          class="am-footer am-footer-default"
           data-am-footer="{  }">
    <div class="am-footer-switch">
    <span class="am-footer-ysp" data-rel="mobile"
          data-am-modal="{target: '#am-switch-mode'}">
          云适配版
    </span>
      <span class="am-footer-divider"> | </span>
      <a id="godesktop" data-rel="desktop" class="am-footer-desktop" href="javascript:">
          电脑版
      </a>
    </div>
    <div class="am-footer-miscs ">

          <p>由<a href="JKL.html">JKL团队</a>
            提供技术支持</p>
        <p>CopyRight©2020  AllMobilize Inc.</p>
        <p><a href="http://www.beian.miit.gov.cn/">粤ICP备20036114</a></p>
    </div>
  </footer>

  <div id="am-footer-modal"
       class="am-modal am-modal-no-btn am-switch-mode-m am-switch-mode-m-default">
    <div class="am-modal-dialog">
      <div class="am-modal-hd am-modal-footer-hd">
        <a href="javascript:void(0)" data-dismiss="modal" class="am-close am-close-spin " data-am-modal-close>&times;</a>
      </div>
      <div class="am-modal-bd">
          您正在浏览的是

        <span class="am-switch-mode-owner">
            云适配
        </span>

        <span class="am-switch-mode-slogan">
              为您当前手机订制的移动网站。
        </span>
      </div>
    </div>
  </div>

		<div class="am-modal am-modal-no-btn" tabindex="-1" id="QRcode">
  <div class="am-modal-dialog">
    <div class="am-modal-hd">请扫码后根据指引充值！
      <a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close>&times;</a>
    </div>
    <div class="am-modal-bd">
     <img src="images/QRcode.png">
    </div>
  </div>
</div>
	
	<script>
	 function start() {
		 window.like_book_id = new Array(9);
	      var nickname=getCookie("nickname");
	  		window.userid=getCookie("userid");
			window.likespage = getQueryString("likespage");
		 var isAdmin = getCookie("admin");
            if(nickname != ""){
		 document.getElementById("username").innerHTML = nickname; 
	  }
	   if(nickname == "" || isAdmin=="1"){
		  alert("未登录或登录角色不符！");
		   window.location.href="login.html";
		   return false;
	  }
	  document.getElementById("likespage"+likespage).className = "am-active";
            $.ajax({            //几个参数需要注意一下
                type: "POST",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                url: "/EComerenceServlet/userlikes" ,//url
                data: "userid="+userid+"&likespage="+likespage,//传入用户id，页码。格式：user_id=****&likespage=**** 页码为likespage，值为1~5，每页取8个值，如page为1时取前8，2时为9-16，以此类推. &为连接两个key的连接符，收到的请求可能已经分开两个key，如果未分开，则需要根据&分开                       
                success: function (respond) {//响应中需要like_book(书名),like_book_id（书id）,like_Au（书作者），每个字段需要8个参考下列
					document.getElementById("like_book_1").innerHTML = respond.like_book_1;
					document.getElementById("like_book_2").innerHTML = respond.like_book_2;
					document.getElementById("like_book_3").innerHTML = respond.like_book_3;
					document.getElementById("like_book_4").innerHTML = respond.like_book_4;
					document.getElementById("like_book_5").innerHTML = respond.like_book_5;
					document.getElementById("like_book_6").innerHTML = respond.like_book_6;
					document.getElementById("like_book_7").innerHTML = respond.like_book_7;
					document.getElementById("like_book_8").innerHTML = respond.like_book_8;
					
					like_book_id[1] = parseInt(respond.like_book_id_1);
					like_book_id[2] = parseInt(respond.like_book_id_2);
					like_book_id[3] = parseInt(respond.like_book_id_3);
					like_book_id[4] = parseInt(respond.like_book_id_4);
					like_book_id[5] = parseInt(respond.like_book_id_5);
					like_book_id[6] = parseInt(respond.like_book_id_6);
					like_book_id[7] = parseInt(respond.like_book_id_7);
					like_book_id[8] = parseInt(respond.like_book_id_8);
					
					document.getElementById("like_Au_1").innerHTML = respond.like_Au_1; 
					document.getElementById("like_Au_2").innerHTML = respond.like_Au_2;
					document.getElementById("like_Au_3").innerHTML = respond.like_Au_3;
					document.getElementById("like_Au_4").innerHTML = respond.like_Au_4;
					document.getElementById("like_Au_5").innerHTML = respond.like_Au_5;
					document.getElementById("like_Au_6").innerHTML = respond.like_Au_6;
					document.getElementById("like_Au_7").innerHTML = respond.like_Au_7;
					document.getElementById("like_Au_8").innerHTML = respond.like_Au_8;
					
                },                
                error : function() {
                    alert("异常！");
                }
            });
		 
		 $.ajax({            //几个参数需要注意一下
                type: "POST",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                url: "/EComerenceServlet/balance" ,//url
                data: "userid="+userid,                
                success: function (respond) {
					document.getElementById("money").innerHTML = "充值(余额："+respond.balance+")";
                },                
                error : function() {
                    alert("异常！");
                }
            });
		}
	  start();
		function dellikes(index){
			$.ajax({            //几个参数需要注意一下
                type: "POST",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                url: "/EComerenceServlet/deleteuserlikes" ,//url
                data: "like_book_id="+like_book_id[index]+"&userid="+userid, //删除函数，传入书的id，用户id，指某用户删除某书，格式：like_book_id=****&userid=****  &为连接两个key的连接符，收到的请求可能已经分开两个key，如果未分开，则需要根据&分开               
                success: function (respond) {//只需要返result为true为删除成功，false为失败。
					if (respond.result == "true"){
						alert("删除成功！");
						window.location.href="userlikes.html?likespage="+likespage;
					}
					if (respond.result == "false"){alert("删除失败 ");}
                },                
                error : function() {
                    alert("异常！");
                }
            });
			
}
	</script>
<!--[if (gte IE 9)|!(IE)]><!-->

<!--<![endif]-->
<!--[if lte IE 8 ]>
<script src="http://libs.baidu.com/jquery/1.11.3/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="assets/js/amazeui.ie8polyfill.min.js"></script>
<![endif]-->
<script src="assets/js/amazeui.min.js"></script>

</body>
</html>